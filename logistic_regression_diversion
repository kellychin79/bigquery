CREATE OR REPLACE MODEL `bigdataassignment2-320523.Assignment2_Data.diverted`
OPTIONS 
    (model_type='logistic_reg',input_label_cols=['diverted']) AS
SELECT 
    DIVERTED,
    CARRIER,
    EXTRACT(YEAR FROM FL_DATE) AS YEAR,
    Month,
    DayOfTheWeek,
    ORIGIN,
    DEST,
    DEP_TIME,
    DEP_DELAY,
    (WHEELS_OFF-WHEELS_ON) AS AIR_TIME,
    DISTANCE
FROM `bigdataassignment2-320523.Assignment2_Data.flights2018to2021AddTailAssignment1`
WHERE DIVERTED IS NOT NULL

